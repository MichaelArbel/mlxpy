<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="4- Advanced features" href="advanced_features.html" /><link rel="prev" title="2- Easy logging" href="easy_logging.html" />

    <!-- Generated with Sphinx 6.1.3 and Furo 2023.03.27 -->
        <title>3- Easy reading - Mlxpy 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Mlxpy 0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">Mlxpy 0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="guide.html">Guide</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="tutorial.html">Tutorial</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="tutorial_introduction.html">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="easy_launching.html">1- Easy launching</a></li>
<li class="toctree-l3"><a class="reference internal" href="easy_logging.html">2- Easy logging</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">3- Easy reading</a></li>
<li class="toctree-l3"><a class="reference internal" href="advanced_features.html">4- Advanced features</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial_conclusion.html">Conclusion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="mlxpy.html">Mlxpy package</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="mlxpy.launching.html">The launcher</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlxpy.logging.html">The logger</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlxpy.reading.html">The reader</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlxpy.scheduling.html">The scheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlxpy.version_managment.html">The version manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlxpy.data_structures.html">Data structures</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="easy-reading">
<h1>3- Easy reading<a class="headerlink" href="#easy-reading" title="Permalink to this heading">#</a></h1>
<p>We have already stored information about 3 runs so far.
We can access this information easily using mlxpy’s reader module, which allows querying results, grouping, and aggregating them. Let’s do this interactively!</p>
<section id="creating-a-result-database">
<h2>Creating a result database<a class="headerlink" href="#creating-a-result-database" title="Permalink to this heading">#</a></h2>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">mlxpy</span> <span class="k">as</span> <span class="nn">mlxpy</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="c1"># Creates a database of results stored by the logger that is accessible using a reader object.</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">parent_log_dir</span> <span class="o">=</span> <span class="s1">&#39;./logs/&#39;</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">mlxpy</span><span class="o">.</span><span class="n">Reader</span><span class="p">(</span><span class="n">parent_log_dir</span><span class="p">)</span>
</pre></div>
</div>
<p>Under the woods, the reader object creates a JSON file ‘database.json’ in the directory parent_log_dir and stores metadata about all runs contained in that directory.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">./logs/</span><a class="headerlink" href="#id1" title="Permalink to this code">#</a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>logs/
├── 1/...
├── 2/...
├── 3/...
└── database.json
</pre></div>
</div>
</div>
<p>This database allows, for instance, obtaining general information about the runs contained in the log directory ‘parent_log_dir’, such as the number of runs or the list of fields that are stored in the various files of the log directories: (e.g. in config.yaml, info.yaml or metrics/):</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="c1"># Displaying the number of runs accessible to the reader</span>
   <span class="o">...</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="mi">3</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="c1"># Displaying all fields accessible in the database.</span>
   <span class="o">...</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">fields</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span>
                                 <span class="n">Type</span>
<span class="n">Fields</span>
<span class="n">config</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">d_int</span>         <span class="s1">&#39;&lt;class &#39;</span><span class="nb">int</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">config</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">device</span>        <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">num_units</span>    <span class="s1">&#39;&lt;class &#39;</span><span class="nb">int</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">config</span><span class="o">.</span><span class="n">num_epoch</span>          <span class="s1">&#39;&lt;class &#39;</span><span class="nb">int</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">config</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">lr</span>     <span class="s1">&#39;&lt;class &#39;</span><span class="nb">float</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">config</span><span class="o">.</span><span class="n">seed</span>               <span class="s1">&#39;&lt;class &#39;</span><span class="nb">int</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">app</span>                  <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">cmd</span>                  <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">end_date</span>             <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">end_time</span>             <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">exec</span>                 <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">hostname</span>             <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">log_dir</span>              <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">log_id</span>               <span class="s1">&#39;&lt;class &#39;</span><span class="nb">int</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">process_id</span>           <span class="s1">&#39;&lt;class &#39;</span><span class="nb">int</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">start_date</span>           <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">start_time</span>           <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">status</span>               <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">user</span>                 <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">work_dir</span>             <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">train</span><span class="o">.</span><span class="n">epoch</span>                    <span class="s1">&#39;LAZYDATA&#39;</span>
<span class="n">train</span><span class="o">.</span><span class="n">loss</span>                     <span class="s1">&#39;LAZYDATA&#39;</span>
</pre></div>
</div>
<p>For instance, the method ‘fields’ displace a table of existing fields along with their type.
You can see that all the user config options are preceded by the prefix ‘config’.
The table also contains all fields stored in the files ‘info.yaml’ of the metadata directory for each run.
Finally, all keys stored by the logger when calling the method ‘log_metrics’ are also available.
Note that these keys are of type ‘LAZYDATA’, meaning that the database does not store these data but only a reference to them (more on this later).</p>
</section>
<section id="querying-the-database">
<h2>Querying the database<a class="headerlink" href="#querying-the-database" title="Permalink to this heading">#</a></h2>
<p>Once the database is created, the reader object allows filtering the database by the values taken by some of its fields.
Not all fields can make a valid query. Only those obtained when displaying the attribute ‘searchable’ are acceptable:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="c1"># Displaying searchable fields must start with info or config</span>
   <span class="o">...</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">searchable</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span>
                                   <span class="n">Type</span>
<span class="n">Fields</span>
<span class="n">config</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">d_int</span>         <span class="s1">&#39;&lt;class &#39;</span><span class="nb">int</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">config</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">device</span>        <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">num_units</span>    <span class="s1">&#39;&lt;class &#39;</span><span class="nb">int</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">config</span><span class="o">.</span><span class="n">num_epoch</span>          <span class="s1">&#39;&lt;class &#39;</span><span class="nb">int</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">config</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">lr</span>     <span class="s1">&#39;&lt;class &#39;</span><span class="nb">float</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">config</span><span class="o">.</span><span class="n">seed</span>               <span class="s1">&#39;&lt;class &#39;</span><span class="nb">int</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">app</span>                  <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">cmd</span>                  <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">end_date</span>             <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">end_time</span>             <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>    <span class="n">info</span><span class="o">.</span><span class="n">exec</span>                 <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">hostname</span>             <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">log_dir</span>              <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">log_id</span>               <span class="s1">&#39;&lt;class &#39;</span><span class="nb">int</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">process_id</span>           <span class="s1">&#39;&lt;class &#39;</span><span class="nb">int</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">start_date</span>           <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">start_time</span>           <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">status</span>               <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">user</span>                 <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
<span class="n">info</span><span class="o">.</span><span class="n">work_dir</span>             <span class="s1">&#39;&lt;class &#39;</span><span class="nb">str</span><span class="s1">&#39;&gt;&#39;</span>
</pre></div>
</div>
<p>The ‘searchable’ fields must start with the prefixes: ‘info.’ or ‘config.’ to indicate that they correspond to keys in the files ‘config.yaml’ and ‘info.yaml’ of the directories ‘metadata’ of the logs.  Let’s make a simple query and use the ‘filter’ method:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="c1"># Searching using a query string</span>
   <span class="o">...</span> <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;info.status == &#39;COMPLETE&#39; &amp; config.optimizer.lr &lt;= 0.1&quot;</span>
   <span class="o">...</span> <span class="n">results</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">query_string</span><span class="o">=</span><span class="n">query</span><span class="p">,</span> <span class="n">result_format</span><span class="o">=</span><span class="s2">&quot;pandas&quot;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="c1"># Display the result as a pandas dataframe</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">results</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span>
   <span class="n">config</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">d_int</span>  <span class="o">...</span>                                         <span class="n">train</span><span class="o">.</span><span class="n">loss</span>
<span class="mi">0</span>                 <span class="mi">10</span>  <span class="o">...</span>  <span class="p">[</span><span class="mf">0.030253788456320763</span><span class="p">,</span> <span class="mf">0.03025251068174839</span><span class="p">,</span> <span class="mf">0.</span><span class="o">...</span>
<span class="mi">1</span>                 <span class="mi">10</span>  <span class="o">...</span>  <span class="p">[</span><span class="mf">0.030253788456320763</span><span class="p">,</span> <span class="mf">0.03024102933704853</span><span class="p">,</span> <span class="mf">0.</span><span class="o">...</span>
</pre></div>
</div>
<p>Here, we call the method ‘filter’ with the option ‘result_format’ set to ‘pandas’. This allows to return the result as a pandas dataframe where the rows correspond to runs stored in the ‘parent_log_dir’ and matching the query. If the query is an empty string, then all entries of the database are returned.</p>
<p>The dataframe’s column names correspond to the fields contained in ‘reader.fields’. These names are constructed as follows:</p>
<ul class="simple">
<li><p>The dot-separated flattened keys of the hierarchical options contained in the YAML file ‘metadata.yaml’ preceded by the prefix ‘metadata’.</p></li>
<li><p>The keys of the dictionaries stored in the files contained in the ‘metrics’ directories (here ‘train.json’) preceded by the file name as a suffix (here: ‘train.’).</p></li>
</ul>
<p>As you can see, the dataframe loads the content of all keys in the files ‘train.json’ (contained in the ‘metrics’ directories of each run), which might not be desirable if these files are large.
This can be avoided using ‘lazy evaluation’ which we describe next.</p>
</section>
<section id="lazy-evaluation">
<h2>Lazy evaluation<a class="headerlink" href="#lazy-evaluation" title="Permalink to this heading">#</a></h2>
<p>Instead of returning the result of the search as a pandas dataframe, which loads all the content of the, possibly large, ‘train.json’ file, we can return a ‘mlxpy.DataDictList’ object.
This object can also be rendered as a dataframe but does not load the ‘train.json’ files in memory unless the corresponding fields are explicitly accessed.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="c1"># Returning a DataDictList as a result</span>
   <span class="o">...</span> <span class="n">results</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">query_string</span><span class="o">=</span><span class="n">query</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="c1"># Display the result as a pandas dataframe</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">results</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span>
   <span class="n">config</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">d_int</span> <span class="n">config</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">device</span>  <span class="o">...</span>  <span class="n">train</span><span class="o">.</span><span class="n">epoch</span> <span class="n">train</span><span class="o">.</span><span class="n">loss</span>
<span class="mi">0</span>                 <span class="mi">10</span>                <span class="n">cpu</span>  <span class="o">...</span>     <span class="n">LAZYDATA</span>    <span class="n">LAZYDATA</span>
<span class="mi">1</span>                 <span class="mi">10</span>                <span class="n">cpu</span>  <span class="o">...</span>     <span class="n">LAZYDATA</span>    <span class="n">LAZYDATA</span>

<span class="p">[</span><span class="mi">2</span> <span class="n">rows</span> <span class="n">x</span> <span class="mi">39</span> <span class="n">columns</span><span class="p">]</span>
</pre></div>
</div>
<p>As you can see, the content of the columns ‘train.epoch’ and ‘train.loss’ is simply marked as ‘LAZYDATA’, meaning that it is not loaded for now. If we try to access a specific column (e.g. ‘train.loss’), DataDictList will automatically load the desired result:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="c1"># Access a particular column of the results</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;train.loss&#39;</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span>
<span class="p">[</span><span class="mf">0.030253788456320763</span><span class="p">,</span> <span class="mf">0.03025251068174839</span><span class="p">,</span> <span class="mf">0.030249962583184242</span><span class="p">,</span> <span class="mf">0.030246131122112274</span><span class="p">,</span> <span class="mf">0.03024103306233883</span><span class="p">,</span> <span class="mf">0.030234655365347862</span><span class="p">,</span> <span class="mf">0.03022700361907482</span><span class="p">,</span> <span class="mf">0.030218079686164856</span><span class="p">,</span> <span class="mf">0.030207885429263115</span><span class="p">,</span> <span class="mf">0.030196424573659897</span><span class="p">]</span>
</pre></div>
</div>
<p>The object results should be viewed as a list of dictionaries. Each element of the list corresponds to a particular run in the  ‘parent_log_dir’ directory. The keys of each dictionary in the list are the columns of the dataframe. Finally, it is always to convert a DataDictList object to a pandas dataframe using the method ‘toPandasDF’.</p>
</section>
<section id="grouping-and-aggregation">
<h2>Grouping and aggregation<a class="headerlink" href="#grouping-and-aggregation" title="Permalink to this heading">#</a></h2>
<p>While it is possible to directly convert the results of a query to a pandas dataframe which supports grouping and aggregation operations,
mlxpy also provides basic support for these operations. Let’s see how this works:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="c1"># List of group keys.</span>
   <span class="o">...</span> <span class="n">group_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;config.optimizer.lr&#39;</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="c1"># Grouping the results</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">grouped_results</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="n">group_keys</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">grouped_results</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span>
                             <span class="n">config</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">d_int</span> <span class="n">config</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">device</span>  <span class="o">...</span>  <span class="n">train</span><span class="o">.</span><span class="n">epoch</span>  <span class="n">train</span><span class="o">.</span><span class="n">loss</span>
<span class="n">config</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">lr</span>                                        <span class="o">...</span>
<span class="mf">0.01</span>                                <span class="mi">10</span>                <span class="n">cpu</span>  <span class="o">...</span>     <span class="n">LAZYDATA</span>    <span class="n">LAZYDATA</span>
<span class="mf">0.10</span>                                <span class="mi">10</span>                <span class="n">cpu</span>  <span class="o">...</span>     <span class="n">LAZYDATA</span>    <span class="n">LAZYDATA</span>

<span class="p">[</span><span class="mi">2</span> <span class="n">rows</span> <span class="n">x</span> <span class="mi">38</span> <span class="n">columns</span><span class="p">]</span>
</pre></div>
</div>
<p>The output is an object of type GroupedDataDicts. It can be viewed as a dictionary whose keys are given by the different values taken by the group variables. Here the group variable is the learning rate ‘config.optimizer.lr’ which takes the values ‘0.01’ and ‘0.10’. Hence, the keys of GroupedDataDicts are ‘0.01’ and ‘0.10’. Each group (for instance the group with key ‘0.01’) is a DataDictList object containing the different runs belonging to that group.</p>
<p>Finally, we can aggregate these groups according to some aggregation operations:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="c1"># Creating the aggregation maps</span>
    <span class="o">...</span> <span class="kn">from</span> <span class="nn">mlxpy.data_structures.contrib.aggregation_maps</span> <span class="kn">import</span> <span class="n">AvgStd</span>
    <span class="o">...</span> <span class="n">agg_maps</span> <span class="o">=</span> <span class="p">[</span><span class="n">AvgStd</span><span class="p">(</span><span class="s1">&#39;train.loss&#39;</span><span class="p">),</span><span class="n">AvgStd</span><span class="p">(</span><span class="s1">&#39;train.epoch&#39;</span><span class="p">)]</span>


<span class="n">In</span> <span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="c1"># Aggregating the results</span>
   <span class="o">...</span><span class="p">:</span> <span class="n">agg_results</span> <span class="o">=</span> <span class="n">grouped_results</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">agg_maps</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">agg_results</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span>
                                      <span class="n">train</span><span class="o">.</span><span class="n">loss_avg</span>  <span class="o">...</span> <span class="n">config</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">lr</span>
<span class="mi">0</span>  <span class="p">[</span><span class="mf">0.030253788456320763</span><span class="p">,</span> <span class="mf">0.03024102933704853</span><span class="p">,</span> <span class="mf">0.</span><span class="o">...</span>  <span class="o">...</span>                 <span class="mf">0.1</span>
<span class="mi">1</span>  <span class="p">[</span><span class="mf">0.030253788456320763</span><span class="p">,</span> <span class="mf">0.03025251068174839</span><span class="p">,</span> <span class="mf">0.</span><span class="o">...</span>  <span class="o">...</span>                <span class="mf">0.01</span>

<span class="p">[</span><span class="mi">2</span> <span class="n">rows</span> <span class="n">x</span> <span class="mi">3</span> <span class="n">columns</span><span class="p">]</span>
</pre></div>
</div>
<p>Here, we compute the average and standard deviation of the field ‘train.loss’ which contains a list of loss values. The loss values are averaged per group and the result is returned as a DataDictList object whose columns consist of:</p>
<ul class="simple">
<li><p>The resulting fields: ‘train.loss_avg’ and ‘train.loss_std’</p></li>
<li><p>The original group key: ‘config.optimizer.lr’.</p></li>
</ul>
<p>Of course, one can always convert these structures to a pandas dataframe at any time!</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="advanced_features.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">4- Advanced features</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="easy_logging.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">2- Easy logging</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Michael Arbel
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">3- Easy reading</a><ul>
<li><a class="reference internal" href="#creating-a-result-database">Creating a result database</a></li>
<li><a class="reference internal" href="#querying-the-database">Querying the database</a></li>
<li><a class="reference internal" href="#lazy-evaluation">Lazy evaluation</a></li>
<li><a class="reference internal" href="#grouping-and-aggregation">Grouping and aggregation</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    </body>
</html>